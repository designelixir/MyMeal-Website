
<p style="margin-bottom: 25px;">Menus with a "Verified MyMeal Partner" <img src="../assets/verified-mymeal.png" class="hover" onclick="verifiedPopUp(true)" style="height: 25px; margin-bottom: -10px;" alt="mymeal verified badge"/> badge have worked with us personally to provide the most accurate information possible to make your dining experience safe. Click the badge for more information on what qualifies a restaurant as a MyMeal partner.
<p>
<div class="directory box-shadow">
	<div id="directory-map-container">
		{@|apply directoryMap.block}
		<div class="directory-filter box-shadow">
			<div class="flex-center-start flex-wrap">
				<p class="white-text">Filter by: </p>
				<div class="category-filter hover" id="reset-categories" style="display: none;">
					<p onclick="reset()">Show All</p>
				</div>
				<div class="category-filter hover flex-center-center" onclick="categorize('verified-item')" id="verified-item" >
					<img src="../assets/verified-mymeal.png" style="height: 15px; margin-bottom: -2px;"/>
					<p> Verified </p>
				</div>
				{.section collection}
				<squarespace:category collection="directory">
					{.if categories}
					{.repeated section categories}
					<div class="category-filter hover" id="{name}">
						<p onclick="categorize('{name}')">{name}</p>
					</div>
					{.end}
					{.end}
				</squarespace:category>
				{.end}
			</div>
		</div>
		<p id="filter-text"><span id="category-count"></span></p>
	</div>

	<div class="flex-start-center flex-wrap directory-wrapper" >
		{.repeated section items}
		<script>
			{.if location}
				var lat = location.markerLat;
				var long = location.markerLng;
				var coordinate = {lat:{location.markerLat}, lng: {location.markerLng}}
				allCoordinates.push(coordinate);
				allContent.push(["<h4>{title}</h4> <p> üìç {location.addressLine1}, {location.addressLine2} </p><br> <div class='flex-center-center'><button class='large-button styled-button hover' onclick='window.open('{sourceUrl}')'>Restaurant Details</button><button class='large-button outline-styled-button hover' onclick='window.open('{sourceUrl}')'>Directions</button></div>"])
			{.end}
		</script>
		{.equal? customContent.customType "duplicateLocation" }
		{.or}
		<article id="{title}" class='directory-list-item hover {.if customContent.verified} verified-item {.or} unverified-item {.end} box-shadow mymeal-verified {categories} {tags} {@|item-classes}' data-item-id="{id}" >
			<div class="directory-image" {.if customContent.bannerImgUrl}style="background-image:url({customContent.bannerImgUrl})"{.or}style="background-image:url(../assets/basic-bg.png)"{.end} >
				<div class="flex-start-end verified-badge-wrapper">
					{.if customContent.verified}
					<img onclick="verifiedPopUp(true)" class="verified-badge hover" src="../assets/verified-mymeal.png">
					{.end}
				</div>
				<div>
					<div class="directory-logo-wrapper flex-center-start">
						{.if assetUrl}
							<div class="directory-logo box-shadow" style="background-image: url({assetUrl})"></div>
						{.end}
						{.equal? customContent.customType "verifiedRestaurantMultiple"}
						<p class="directory-city box-shadow">Multiple Locations</p>
						{.or}
						<p class="directory-city hover box-shadow" onclick="window.open('https://www.google.com/maps/search/{location.addressTitle} {location.addressLine1} {location.addressLine2}', '_blank')" id="address-span"></p>
						<script>
						function removeAfterSecondComma(str, title) {
							var splitStr = str.split(',');
							if (splitStr.length >= 3) {
								splitStr.splice(2);
							}
							
							var modifiedStr = splitStr.join(',');
							document.getElementById(title + '-address-span').innerHTML = "üìç " + modifiedStr;
							}
							if (`{title}`.includes('&')){
							
							var title = `{title}`.replace(/&amp;/g, "and")
							document.getElementById('address-span').id = title + '-address-span'
							removeAfterSecondComma(`{location.addressLine2}`, title)
							} else {
								document.getElementById('address-span').id = `{title}` + '-address-span'
								removeAfterSecondComma(`{location.addressLine2}`, `{title}`)
							}
						</script>
						{.end}
					</div>
				</div>
			</div>
			<div class="directory-info-container" onclick="window.open('{fullUrl}', '_self')">
				<p class="blog-title" data-content-field="title">{title}</p>
				<div class="flex-center-start flex-wrap">
					{.if customContent.priceRank}<p>{customContent.priceRank} &nbsp;‚Ä¢&nbsp;</p>{.end}
					{.if categories} 
						{.repeated section categories}
						<a class="category-label drop-shadow" href="{collection.fullUrl}?category={@|url-encode}">{@|url-encode}</a>&nbsp;
						{.end}
					{.end}
					{.if tags }
					<a class="tag-label drop-shadow" id="tagger"></a>&nbsp;	
					<script>
						function checkTags(title, tags){
							if (tags.includes(',')){
							var modifiedTags = tags.replace(/,/g, ", ");
							document.getElementById(title + "-tags").innerHTML = "&#x2713;<span>&nbsp;" + modifiedTags + "</span> Free Kitchen"
							} else {
								document.getElementById(title + "-tags").innerHTML = "&#x2713;<span>&nbsp;" + tags + "</span> Free Kitchen"
							}
						}
							if (`{title}`.includes('&')){
							var title = `{title}`.replace(/&amp;/g, "and")
							document.getElementById('tagger').id = title + '-tags'
							checkTags(title, `{tags}`)
							} else {
								document.getElementById('tagger').id = `{title}` + '-tags'
								checkTags(`{title}`, `{tags}`)
							}
					</script>
					{.end}
				</div>
				<div class="flex-center-center directory-buttons">
					<button onclick="window.open('{sourceUrl}')" class="medium-button styled-button">Allergen Menu</button>
					<button onclick="window.open('{fullUrl}', '_self')" class="medium-button styled-button-inverted">Details</button>
				</div>
			</div>
		</article>
	{.end}
	
	{.end}
</div>
