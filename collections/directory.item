<script>
console.log(String({customContent.specialtyItems}))
function addToSpecialtyItems() {
  var span = document.getElementById('preprocess-specialty-items'); // Get the span element
  var div = document.getElementById('specialtyItems'); // Get the div element

  // Retrieve the text content from the span and split it by commas
  var items = span.textContent.split(',');

  // Iterate through the items and create a list item for each
  for (var i = 0; i < items.length; i++) {
    var listItem = document.createElement('li'); // Create a new list item
    listItem.textContent = items[i].trim(); // Set the text content of the list item, trimming any extra whitespace
    div.appendChild(listItem); // Add the list item to the div
  }
}

    function switchTab(tabIndex) {
      
      var tabs = document.getElementsByClassName("directory-tab");
      var buttons = document.getElementsByClassName("tab-button")
      

      
      var selectedTab = document.getElementById("tab" + (tabIndex + 1));
      var selectedTabButton = document.getElementById("tab-button-" + (tabIndex + 1))
      if (selectedTab) {
        for (var i = 0; i < tabs.length; i++) {
        tabs[i].classList.remove("visible-tab")
        buttons[i].classList.remove("active-tab-button")
      }
        selectedTab.classList.add("visible-tab")
        selectedTabButton.classList.add("active-tab-button")
      }
    }
  </script>
{.section item}
<div class="directory-breadcrumbs flex-center-start flex-wrap">

<h2 class="directory-breadcrumb-child">{title}</h2>
</div>
<br>
<a href="/directory" class="styled-button-inverted large-button">&larr; Back to Directory</a>
<div style="height: 50px"></div>
<section class="box-shadow" style="border-radius: 8px">
    
      <div class="directory-image-lg flex-start-spacebetween" {.if customContent.bannerImgUrl}style="background-image:url({customContent.bannerImgUrl})"{.or}style="background-image:url(../assets/basic-bg.png)"{.end}>
        <div class="directory-header-wrapper">
            <div class="flex-center-start directory-header-logo-info">
                {.if customContent.brandlogo}
                <div class="directory-header-logo-container">
                <img src="{customContent.brandlogo.assetUrl}"  class="directory-header-logo" alt="{title} logo">
                </div>
                {.end}
                <div class="directory-header-info">
                <div class="flex-center-start">
                {.if customContent.verified}<img src="../assets/verified-mymeal.png" style="height: 35px; margin-right: 5px;" class="hover" onclick="verifiedPopUp(true)" alt="mymeal verified badge"/>{.end}
                <h2 style="color: black;">{title}</h2></div>
            {.if location}
                <p class=" hover" onclick="window.open('https://www.google.com/maps/search/{location.addressTitle} {location.addressLine1} {location.addressLine2}', '_blank')">üìç {location.addressLine1}, {location.addressLine2}</p>
            {.end}
            <div class="flex-center-start flex-wrap" style="margin: 7px 0px;">
                {customContent.priceRank}  
                {.if categories }&nbsp;‚Ä¢&nbsp;
                {.repeated section categories}
                <a class="category-label drop-shadow" href="{collection.fullUrl}?tag={@|url-encode}">{@|url-encode}</a>&nbsp;
                {.end}
                {.end}
                {.if tags }
                {.repeated section tags}
                <a class="tag-label drop-shadow" href="{collection.fullUrl}?tag={tags}">&#x2713; {tags} Free Kitchen</a>&nbsp;
                {.end}
                {.end}
            </div>
            
            </div>
            
        
        </div>
            
        </div>
        
        
      </div>
    
        
    
    <div class="directory-page-info">
    <div class="restaurant-tab-container">

    
        <button onclick="switchTab(0)" class="tab-button active-tab-button" id="tab-button-1">
          {.if customContent.verified}Allergen Menu{.or}Details{.end}</button>
    
        <button onclick="switchTab(1)" class="tab-button" id="tab-button-2">Reviews</button>
  
    
    
  <div id="tab1" class="directory-tab visible-tab ">
  <div class="directory-details light-padding">
  {.if customContent.verified}{.or}<p>This restaurant is <strong>not verified with MyMeal.</strong> We've vetted this restaurant as a good candidate for a filterable allergen menu based on our community's feedback, and we've gathered basic information about their kitchen procedures. Request this restaurant with the form below, and we'll contact you if they work with us to make a filterable allergen menu!</p>{.end}
    <h4 style="color: var(--blue)">Details:</h4>
    {.if customContent.specialtyItems}
    
    <span id="preprocess-specialty-items">{customContent.specialtyItems}</span>
    <div id="specialtyItems" class="flex-center-start">
    <p style="font-weight: 700;">Specialty Items: &nbsp;</p>
    </div>
    <script>addToSpecialtyItems(`{customContent.specialtyItems}`)</script>
    <div class="hr-line"></div>
    {.end}
    {.if tags }
    <div class="flex-center-start">
        {.repeated section tags}
        
        <p style="font-weight: 700;">Dedicated Free From: &nbsp;</p>
        <p ><span class="tag-label">{tags} </span></p>
        {.end}
        </div>
        <div class="hr-line"></div>
        
        {.end}

      <p style="font-weight: 700;">Cross Contact Procedures:</p>
      <ul class="green-procedures">
        {.if customContent.cookSeperate}
            <li class="yes-procedure"> Cooks on seperate equipment </li>
            {.or}
            {.if customContent.uponRequestCookSeperate}
            <li class="request-procedure"> Cooks on seperate equipment (upon request)</li>
            {.or}
            <li class="no-procedure"> Cooks on seperate equipment </li>
            {.end}
        {.end}
        {.if customContent.untouchedIngredients}
            <li class="yes-procedure"> Uses untouched ingredients </li>
            {.or}
            {.if customContent.uponRequestUntouchedIngredients}
            <li class="request-procedure"> Uses untouched ingredients (only upon request)</li>
            {.or}
            <li class="no-procedure"> Uses untouched ingredients </li>
            {.end}
        {.end}
        {.if customContent.cleanUtensils}
            <li class="yes-procedure"> Uses clean utensils </li>
            {.or}
            {.if customContent.uponRequestCleanUtensils}
            <li class="request-procedure"> Uses clean utensils (only upon request)</li>
            {.or}
            <li class="no-procedure"> Uses clean utensils </li>
            {.end}
        {.end}
        {.if customContent.changeGloves}
            <li class="yes-procedure"> Changes gloves </li>
            {.or}
            {.if customContent.uponRequestChangeGloves}
            <li class="request-procedure"> Changes gloves (only upon request)</li>
            {.or}
            <li class="no-procedure"> Changes gloves </li>
            {.end}
        {.end}
        {.if customContent.hasAllergyMenu}
            <li class="yes-procedure"> Has an allergy menu </li>
            {.or}
            {.if customContent.uponRequestHasAllergyMenu}
            <li class="request-procedure"> Has an allergy menu - (only on MyMeal App)</li>
            {.or}
            <li class="no-procedure"> Has an allergy menu </li>
            {.end}
        {.end}
        {.if customContent.marksAllergen}
            <li class="yes-procedure"> Marks your order "allergy alert" </li>
            {.or}
            {.if customContent.uponRequestHasAllergyMenu}
            <li class="request-procedure"> Marks your order "allergy alert" - (only upon request)</li>
            {.or}
            <li class="no-procedure"> Marks your order "allergy alert" </li>
            {.end}
        {.end}
        {.if customContent.allergenResource}
            <li class="yes-procedure"> Has a staff allergen resource booklet </li>
            {.or}
            
            <li class="no-procedure"> Has a staff allergen resource booklet </li>
            
        {.end}
       
      </ul>
      <div class="hr-line"></div>
      
      {body}
      <div class="hr-line"></div>

    </div>
      {.if customContent.verified}
      
      <h4 style="color: var(--blue); padding-left: 25px;">Allergen Menu:</h4>
      <div class="iframe-container" id="mymeal-menu-iframe">
        <iframe src="{sourceUrl}" frameborder="0" allowfullscreen></iframe>
      </div>
      
      {.or}
      <h4 style="color: var(--blue); padding-left: 25px;">Request This Restaurant:</h4>
    <iframe
      id="JotFormIFrame-230596919059065"
      title="MyMeal Restaurant Request Form"
      onload="window.parent.scrollTo(0,0)"
      allowtransparency="true"
      allowfullscreen="true"
      allow="geolocation; microphone; camera"
      src="https://form.jotform.com/230596919059065?restaurantName={title}"
      frameborder="0"
      style="min-width:100%;max-width:100%;height:539px;border:none;"
      scrolling="no"
    >
    </iframe>
  
    </div>
    {.end}
  
  <div id="tab2" class="directory-tab">
    <h4 style="color: var(--blue)">What Our Community is Saying About {title}</h4>
    {.if customContent.appRating}
    <div class="flex-center-start">
      <p>MyMeal App Rating:</p>
      <div class="star-ratings" style="transform: scale(0.5)">
      <div class="fill-ratings" style="width: 50%;">
        <span>‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
      </div>
      <div class="empty-ratings">
        <span>‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
      </div>
      
    </div>
    </div>
    {.end}
    {@|comments}       
  </div>
  

  


</section>
<br>


{.end}

<script>
console.log({customContent.specialtyItems})
$(document).ready(function() {

      
      var starRating = Number({customContent.appRating});
      var star_rating_width = $('.fill-ratings span').width();
      $('.star-ratings').width(starRating / 10);
    });
</script>