<script>
	function addToSpecialtyItems() {
	  var span = document.getElementById('preprocess-specialty-items'); // Get the span element
	  var div = document.getElementById('specialtyItems'); // Get the div element
	
	  // Retrieve the text content from the span and split it by commas
	  var items = span.textContent.split(',');
	
	  // Iterate through the items and create a list item for each
	  for (var i = 0; i < items.length; i++) {
	    var listItem = document.createElement('li'); // Create a new list item
	    listItem.textContent = items[i].trim(); // Set the text content of the list item, trimming any extra whitespace
	    div.appendChild(listItem); // Add the list item to the div
	  }
	}
	  
</script>
{.section item}
<div class="directory-breadcrumbs flex-center-start flex-wrap">
	<h2 class="directory-breadcrumb-child">{title}</h2>
</div>
<br>
<a href="/directory" class="styled-button-inverted large-button">&larr; Back to Directory</a>
<div style="height: 50px"></div>
<section class="box-shadow" style="border-radius: 8px">
	<div class="directory-image-lg flex-start-spacebetween" {.if customContent.bannerImgUrl}style="background-image:url({customContent.bannerImgUrl})"{.or}style="background-image:url(../assets/basic-bg.png)"{.end}>
	<div class="directory-header-wrapper">
		<div class="flex-center-start directory-header-logo-info">
			{.if assetUrl}
			<div class="directory-header-logo-container">
				<img src="{assetUrl}"  class="directory-header-logo" alt="{title} logo">
			</div>
			{.end}
			<div class="directory-header-info">
				<div class="flex-start-spacebetween flex-wrap">
					<div class="flex-center-start">
						{.if customContent.verified}<img src="../assets/verified-mymeal.png" style="height: 35px; margin-right: 5px;" class="hover" onclick="verifiedPopUp(true)" alt="mymeal verified badge"/>{.end}
						<h2 style="color: black;">{title}</h2>
					</div>
					<div class="flex-center-center">
						{.if customContent.restaurantPhone}
						<div class="icon-with-label" onclick="window.open('tel:`{customContent.restaurantPhone}`', '_blank')">
							<span>Call {customContent.restaurantPhone}</span>
							<img src="../assets/call.png" style="height: 40px; margin-right: 10px;">
						</div>
						{.end}
						{.equal? customContent.customType "verifiedRestaurantMultiple"}{.or}{.if location}
						<div class="icon-with-label" onclick="window.open('https://www.google.com/maps/search/{location.addressTitle} {location.addressLine1} {location.addressLine2}', '_blank')">
							<span>Click for directions</span>
							<img src="../assets/directions.png" style="height: 40px; margin-right:10px;">
						</div>
						{.end}
						{.end}
						{.equal? customContent.customType "verifiedRestaurantMultiple"}{.or}{.if customContent.orderOnline}
						<div class="order-icon-with-label flex-center-center" onclick="window.open('{customContent.orderOnline}', '_blank')">
							<img src="../assets/toGo.png" style="height: 40px;">
							<p class="white-text">Order Online</p>
						</div>
						{.end}
						{.end}
					</div>
				</div>
				
				<div style="margin: 7px 0px;">
				<div class="flex-center-start">
					<p>{customContent.priceRank} &nbsp;‚Ä¢&nbsp;</p>
					{.if categories }
					<div class="flex-center-start flex-wrap">
					{.repeated section categories}
					<a class="category-label drop-shadow" href="/directory?category={@|url-encode}">{@|url-encode}</a>&nbsp;
					{.end}
					</div>
					{.end}
					{.equal? customContent.customType "verifiedRestaurantMultiple"}
						<p class="hover" onclick="switchTab(1)">&nbsp;‚Ä¢&nbsp; Multiple Locations </p>
					{.or}
					{.end}
				</div>
					{.equal? customContent.customType "verifiedRestaurantMultiple"}
						{.or}
						{.if location}
						<p class=" hover" onclick="window.open('https://www.google.com/maps/search/{location.addressTitle} {location.addressLine1} {location.addressLine2}', '_blank')">üìç {location.addressLine1}, {location.addressLine2}</p>
						{.end}
					{.end}
				</div>
			</div>
		</div>
	</div>
	</div>
	<div class="directory-page-info">
	{.equal? customContent.customType "verifiedRestaurantMultiple"}
	<script>
	function switchTab(tabIndex) {
			
		var tabs = document.getElementsByClassName("directory-tab");
		var buttons = document.getElementsByClassName("tab-button")
		
	
		
		var selectedTab = document.getElementById("tab" + (tabIndex + 1));
		var selectedTabButton = document.getElementById("tab-button-" + (tabIndex + 1))
		if (selectedTab) {
			for (var i = 0; i < tabs.length; i++) {
			tabs[i].classList.remove("visible-tab")
		}

		for (var i = 0; i < buttons.length; i++) {
		buttons[i].classList.remove("active-tab-button")
		}

		
			selectedTab.classList.add("visible-tab")
			selectedTabButton.classList.add("active-tab-button")
		}
		}
	</script>

	<div class="restaurant-tab-container">
		<button onclick="switchTab(0)" class="tab-button active-tab-button" id="tab-button-1">Details</button>
		<button onclick="switchTab(1)" class="tab-button" id="tab-button-2">Locations</button>
		{#  <button onclick="switchTab(2)" class="tab-button" id="tab-button-3">Reviews</button>  }
	</div>
	{.end}
    
    
	<div id="tab1" class="directory-tab visible-tab">
		<div class="directory-details light-padding">
			
			{.if customContent.specialtyItems}
			<span id="preprocess-specialty-items">{customContent.specialtyItems}</span>
			<div id="specialtyItems" class="flex-center-start flex-wrap">
				<p style="font-weight: 700;">Specialty Items: &nbsp;</p>
			</div>
			<script>addToSpecialtyItems(`{customContent.specialtyItems}`)</script>
			<div class="hr-line"></div>
			{.end}
			{.if tags }
			<div class="flex-center-start flex-wrap" id="tag-list">
				<p style="font-weight: 700;">Dedicated Free From: &nbsp;</p>
			</div>
			<script>
				checkTags(`{tags}`)
				function checkTags(tags){
				
				var tagsArray = tags.split(',');
				var modifiedTags = tagsArray.map(function(tag) {
				var tagLabel = document.createElement('div');
				tagLabel.className = 'tag-label-individual';
				tagLabel.innerHTML = "&#x2713;<span>&nbsp;" + tag.trim() + "</span>";
				document.getElementById('tag-list').appendChild(tagLabel);
				});
				}
			</script>
			<div class="hr-line"></div>
			{.end}
			{.if customContent.hideCrossContact}
			{.or}
			<p style="font-weight: 700;">Cross Contact Procedures:</p>
			<ul class="green-procedures">
				{.if customContent.cookSeperate}
				<li class="yes-procedure"> Cooks on seperate equipment </li>
				{.or}
				{.if customContent.uponRequestCookSeperate}
				<li class="request-procedure"> Cooks on seperate equipment (upon request)</li>
				{.or}
				<li class="no-procedure"> Cooks on seperate equipment </li>
				{.end}
				{.end}
				{.if customContent.untouchedIngredients}
				<li class="yes-procedure"> Uses untouched ingredients </li>
				{.or}
				{.if customContent.uponRequestUntouchedIngredients}
				<li class="request-procedure"> Uses untouched ingredients (only upon request)</li>
				{.or}
				<li class="no-procedure"> Uses untouched ingredients </li>
				{.end}
				{.end}
				{.if customContent.cleanUtensils}
				<li class="yes-procedure"> Uses clean utensils </li>
				{.or}
				{.if customContent.uponRequestCleanUtensils}
				<li class="request-procedure"> Uses clean utensils (only upon request)</li>
				{.or}
				<li class="no-procedure"> Uses clean utensils </li>
				{.end}
				{.end}
				{.if customContent.changeGloves}
				<li class="yes-procedure"> Changes gloves </li>
				{.or}
				{.if customContent.uponRequestChangeGloves}
				<li class="request-procedure"> Changes gloves (only upon request)</li>
				{.or}
				<li class="no-procedure"> Changes gloves </li>
				{.end}
				{.end}
				{.if customContent.hasAllergyMenu}
				<li class="yes-procedure"> Has an allergy menu </li>
				{.or}
				{.if customContent.uponRequestHasAllergyMenu}
				<li class="request-procedure"> Has an allergy menu - (only on MyMeal App)</li>
				{.or}
				<li class="no-procedure"> Has an allergy menu </li>
				{.end}
				{.end}
				{.if customContent.marksAllergen}
				<li class="yes-procedure"> Marks your order "allergy alert" </li>
				{.or}
				{.if customContent.uponRequestHasAllergyMenu}
				<li class="request-procedure"> Marks your order "allergy alert" - (only upon request)</li>
				{.or}
				<li class="no-procedure"> Marks your order "allergy alert" </li>
				{.end}
				{.end}
				{.if customContent.allergenResource}
				<li class="yes-procedure"> Has a staff allergen resource booklet </li>
				{.or}
				<li class="no-procedure"> Has a staff allergen resource booklet </li>
				{.end}
			</ul>
			<div class="hr-line"></div>
			{.end}
			{.if body}
			<h4 style="color: var(--blue)">Details:</h4>
			{body}
			<div class="hr-line"></div>
			{.end}
		</div>
		{.if customContent.verified}
		{.if sourceUrl}
		<h4 style="color: var(--blue); padding-left: 25px;">Allergen Menu:</h4>
		<div class="iframe-container" id="mymeal-menu-iframe">
			<iframe src="{sourceUrl}" frameborder="0" allowfullscreen></iframe>
		</div>
		{.or}
		<h4 style="color: var(--blue); padding-left: 25px;">Allergen Menu:</h4>
		<p style="padding: 0px 25px;">This restaurant has different MyMeal menus for its locations. Click the "Locations" tab to view each menu.</p>
		{.end}
		{.or}
		<div style="padding: 0px 25px">
			<h4 style="color: var(--blue);">Request This Restaurant:</h4>
			<p>This restaurant is <strong>not verified with MyMeal.</strong> We've vetted this restaurant as a good option based on our community's feedback or personal experience. {.if customContent.hideCrossContact} {.or} We've gathered basic information about their kitchen procedures. {.end} Request a filterable allergy menu for this restaurant with the form below, and we'll contact you if they work with us to become verified.</p>
		</div>
			
		<iframe
			id="JotFormIFrame-230596919059065"
			title="MyMeal Restaurant Request Form"
			onload="window.parent.scrollTo(0,90)"
			allowtransparency="true"
			allowfullscreen="true"
			allow="geolocation; microphone; camera"
			src="https://form.jotform.com/230596919059065?restaurantName={title}"
			frameborder="0"
			style="border:none;"
			scrolling="no"
			

			>
		</iframe>
		{.end}
	</div>
	
	{.equal? customContent.customType "verifiedRestaurantMultiple"}
		<div id="tab2" class="directory-tab">
			{@|apply directoryMap.block}
			<squarespace:query collection="directory" limit="100" tag={title|slugify}>
				<div class="flex-start-start flex-wrap">
				{.repeated section items}
				<script>
					{.if location}
						var lat = location.markerLat;
						var long = location.markerLng;
						var coordinate = {lat:{location.markerLat}, lng: {location.markerLng}}
						allCoordinates.push(coordinate);
						allContent.push(["<h4 class='multiple-location-title'>{title}</h4> <p>üìû {customContent.restaurantPhone}</p><p> üìç {location.addressLine1}, {location.addressLine2} </p><br> <div class='flex-center-center'><button class='medium-button styled-button hover' onclick='goToDetails(`{id}`)'>Restaurant Details</button><button class='medium-button outline-styled-button hover' onclick='window.open('{sourceUrl}')'>Directions</button></div>"])
					{.end}
					function doStuff(id){
							document.getElementById(id).style.border = "2px solid var(--blue)"
							document.getElementById(id).style.borderRadius = "6px 6px 0px 0px"
							showDetails(id);
						}
					function goToDetails(id){
						document.getElementById(id).scrollIntoView({ behavior: 'smooth', block: "center" });
						
						setTimeout(() => {
						doStuff(id)
						
						}, 500);
						
					}
				</script>
				{.equal? customContent.customType "duplicateLocation"}
					<div class="multiple-location-wrapper box-shadow">
						<div id="{id}" class="{tags}">
						<div style="padding: 0px 15px;"class="flex-center-spacebetween"><h4 class="multiple-location-title">{title}</h4> <button class="large-button styled-button" style="min-width: 140px;" onclick="window.open('{customContent.orderOnline}')">Order Online</button></div>
						
						<div style="padding: 0px 15px;">
						{.if location}
							<div class="flex-center-start hover" onclick="window.open('https://www.google.com/maps/search/{location.addressTitle} {location.addressLine1} {location.addressLine2}', '_blank')">
							<img src="../assets/directions.png" style="height: 30px; margin-right: 10px;">
							<p>&nbsp;{location.addressLine1}, {location.addressLine2}</p>
							</div>
							{.end}
							{.if customContent.restaurantPhone}
							<div class="flex-center-start hover" onclick="window.open('tel:`{customContent.restaurantPhone}`', '_blank')">
							<img src="../assets/call.png" style="height: 30px; margin-right: 10px;">
							<p>&nbsp;{customContent.restaurantPhone}</p>
							</div>
							{.end}
						</div>
						<br>
						<script>
							function showDetails(id){
								console.log(id)
								var targetDetails = document.getElementById(id + '-additionalDetails');
								var targetArrow = document.getElementById(id + '-detailsArrow');
								if (targetDetails.style.display === "none"){
									targetDetails.style.display = "block"
									targetArrow.innerHTML = "Click for location details &#9660;"
									$(".multi-location-iframe").show(function(){
										$(this).find("iframe").prop("src", function(){
											return $(this).data("src");
										});
									});
									
								} else {
									targetDetails.style.display = "none"
									targetArrow.innerHTML = "Click for location details &#9654;"
								}
							}
						</script>
						<div onclick="showDetails('{id}')" class="hover"><p style="padding: 0px 15px; margin: 0 0 25px" id="{id}-detailsArrow">Click for location details &#9654;</p></div>
						</div>
						<div class="additional-details fade-in" id="{id}-additionalDetails" style="padding: 15px; display: none;">
						{.if customContent.specialtyItems}
						<p><strong>Speciality Items:</strong> {customContent.specialtyItems}</p>
						{.end}
						{.if body}
							<div class="hr-line"></div>
							<h4 style="color: var(--blue)">Details:</h4>
							{body}
							{.end}
							{.if sourceUrl}
							<div class="multi-location-iframe">
								<h4 style="color: var(--blue); padding-left: 25px;">Allergen Menu:</h4>
								<iframe data-src="{sourceUrl}" frameborder="0" style="width: 100%; min-height: 800px;" allowfullscreen></iframe>
							</div>
							{.end}
							{.if customContent.hideCrossContact}
			{.or}
			<p style="font-weight: 700;">Cross Contact Procedures:</p>
			<ul class="green-procedures">
				{.if customContent.cookSeperate}
				<li class="yes-procedure"> Cooks on seperate equipment </li>
				{.or}
				{.if customContent.uponRequestCookSeperate}
				<li class="request-procedure"> Cooks on seperate equipment (upon request)</li>
				{.or}
				<li class="no-procedure"> Cooks on seperate equipment </li>
				{.end}
				{.end}
				{.if customContent.untouchedIngredients}
				<li class="yes-procedure"> Uses untouched ingredients </li>
				{.or}
				{.if customContent.uponRequestUntouchedIngredients}
				<li class="request-procedure"> Uses untouched ingredients (only upon request)</li>
				{.or}
				<li class="no-procedure"> Uses untouched ingredients </li>
				{.end}
				{.end}
				{.if customContent.cleanUtensils}
				<li class="yes-procedure"> Uses clean utensils </li>
				{.or}
				{.if customContent.uponRequestCleanUtensils}
				<li class="request-procedure"> Uses clean utensils (only upon request)</li>
				{.or}
				<li class="no-procedure"> Uses clean utensils </li>
				{.end}
				{.end}
				{.if customContent.changeGloves}
				<li class="yes-procedure"> Changes gloves </li>
				{.or}
				{.if customContent.uponRequestChangeGloves}
				<li class="request-procedure"> Changes gloves (only upon request)</li>
				{.or}
				<li class="no-procedure"> Changes gloves </li>
				{.end}
				{.end}
				{.if customContent.hasAllergyMenu}
				<li class="yes-procedure"> Has an allergy menu </li>
				{.or}
				{.if customContent.uponRequestHasAllergyMenu}
				<li class="request-procedure"> Has an allergy menu - (only on MyMeal App)</li>
				{.or}
				<li class="no-procedure"> Has an allergy menu </li>
				{.end}
				{.end}
				{.if customContent.marksAllergen}
				<li class="yes-procedure"> Marks your order "allergy alert" </li>
				{.or}
				{.if customContent.uponRequestHasAllergyMenu}
				<li class="request-procedure"> Marks your order "allergy alert" - (only upon request)</li>
				{.or}
				<li class="no-procedure"> Marks your order "allergy alert" </li>
				{.end}
				{.end}
				{.if customContent.allergenResource}
				<li class="yes-procedure"> Has a staff allergen resource booklet </li>
				{.or}
				<li class="no-procedure"> Has a staff allergen resource booklet </li>
				{.end}
			</ul>
			<div class="hr-line"></div>
			{.end}
						</div>
					</div>
					{.end}

				
				{.end}
				</div>
			</squarespace:query>
		</div>
	{.end}

	<div id="tab3" class="directory-tab" style="padding: 25px;">
		<h4 style="color: var(--blue)">What Our Community is Saying About {title}</h4>
		{.if customContent.appRating}
		<div class="flex-center-start">
			<p>MyMeal App Rating:</p>
			<div class="star-ratings" style="transform: scale(0.5)">
				<div class="fill-ratings" style="width: 50%;">
					<span>‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
				</div>
				<div class="empty-ratings">
					<span>‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
				</div>
			</div>
		</div>
		{.end}
	</div>
</div>
</section>
<br>
{.end}




<script>
console.log(allCoordinates)
$(document).ready(function() {
	var starRating = Number({customContent.appRating});
	var star_rating_width = $('.fill-ratings span').width();
	$('.star-ratings').width(starRating / 10);
});
</script>